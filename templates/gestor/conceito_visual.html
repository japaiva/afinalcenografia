<!-- templates/gestor/conceito_visual.html - VERSÃO 2 SIMPLIFICADA -->
{% extends 'gestor/base_gestor.html' %}
{% load formatadores %}

{% block title %}Conceito Visual - {{ projeto.nome }} | Portal do Gestor{% endblock %}

{% block content %}
<div class="container-fluid py-3">
  <!-- CABEÇALHO -->
  <div class="card shadow mb-4">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        <i class="fas fa-paint-brush me-2"></i>
        <h4 class="mb-0">Conceito Visual - {{ projeto.nome }}</h4>
      </div>
      <div class="d-flex gap-2">
        <button class="btn btn-success" onclick="executarProcessoCompleto()">
          <i class="fas fa-play-circle me-1"></i> Executar Tudo
        </button>
        <a href="{% url 'gestor:projeto_detail' pk=projeto.id %}" class="btn btn-outline-secondary">
          <i class="fas fa-arrow-left me-1"></i> Voltar
        </a>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- COLUNA ESQUERDA -->
    <div class="col-md-8">
      
      <!-- ETAPA 1: ANÁLISE DE ESBOÇO -->
      <div class="card shadow mb-4">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">
            <span class="badge bg-white text-primary rounded-circle me-2">1</span>
            Análise do Esboço
          </h5>
          <div class="d-flex gap-2 align-items-center">
            <span class="badge bg-light text-dark" id="status-badge-1">Não Executado</span>
            <button class="btn btn-light btn-sm" onclick="executarEtapa1()" id="btn-etapa1">
              <i class="fas fa-play text-primary me-1"></i> Executar
            </button>
          </div>
        </div>
        <div class="card-body">
          <p class="text-muted">
            <i class="fas fa-info-circle me-1"></i>
            Extrai a estrutura espacial do esboço: áreas, dimensões e layout.
          </p>
          
          {% if arquivos_planta %}
          <div class="mb-3">
            <p class="fw-bold">{{ arquivos_planta|length }} esboço(s) de planta disponível(is)</p>
          </div>
          {% else %}
          <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle me-2"></i>
            Nenhum esboço de planta disponível. Faça upload no briefing primeiro.
          </div>
          {% endif %}

          <!-- Resultado -->
          <div class="result-container d-none" id="result-1">
            <div class="alert alert-success">
              <i class="fas fa-check-circle me-2"></i> Layout extraído com sucesso
            </div>
            
            <div class="row">
              <div class="col-md-8">
                <h6 class="fw-bold">Layout Identificado:</h6>
                <pre class="bg-light p-3 rounded small" id="layout-json" style="max-height: 300px; overflow-y: auto;"></pre>
              </div>
              <div class="col-md-4">
                <div id="arquivo-info-1" class="d-none">
                  <h6 class="fw-bold">Arquivo Analisado:</h6>
                  <div class="text-center">
                    <img id="esboco-thumb" src="" class="img-fluid rounded shadow-sm mb-2" style="max-height:200px;">
                    <p class="small text-muted mb-0" id="esboco-nome"></p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Loading -->
          <div class="text-center d-none" id="loading-1">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Processando...</span>
            </div>
            <p class="mt-2 text-muted">Analisando esboço...</p>
          </div>
        </div>
      </div>

      <!-- ETAPA 2: ANÁLISE DE REFERÊNCIAS -->
      <div class="card shadow mb-4">
        <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">
            <span class="badge bg-white text-info rounded-circle me-2">2</span>
            Análise de Referências Visuais
          </h5>
          <div class="d-flex gap-2 align-items-center">
            <span class="badge bg-light text-dark" id="status-badge-2">Não Executado</span>
            <button class="btn btn-light btn-sm" onclick="executarEtapa2()" id="btn-etapa2">
              <i class="fas fa-play text-info me-1"></i> Executar
            </button>
          </div>
        </div>
        <div class="card-body">
          <p class="text-muted">
            <i class="fas fa-info-circle me-1"></i>
            Extrai paleta de cores, estilos e inspirações das imagens de referência.
          </p>
          
          {% if arquivos_referencia %}
          <div class="mb-3">
            <p class="fw-bold">{{ arquivos_referencia|length }} imagem(ns) de referência disponível(is)</p>
          </div>
          {% else %}
          <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle me-2"></i>
            Nenhuma imagem de referência disponível. Faça upload no briefing primeiro.
          </div>
          {% endif %}

          <!-- Resultado -->
          <div class="result-container d-none" id="result-2">
            <div class="alert alert-success">
              <i class="fas fa-check-circle me-2"></i> Inspirações extraídas com sucesso
            </div>
            
            <h6 class="fw-bold">Análise Visual:</h6>
            <pre class="bg-light p-3 rounded small" id="inspiracoes-json" style="max-height: 300px; overflow-y: auto;"></pre>
            
            <!-- Preview de cores -->
            <div id="cores-preview" class="mt-3 d-none">
              <h6 class="fw-bold">Paleta de Cores:</h6>
              <div class="d-flex gap-2" id="cores-container"></div>
            </div>
          </div>

          <!-- Loading -->
          <div class="text-center d-none" id="loading-2">
            <div class="spinner-border text-info" role="status">
              <span class="visually-hidden">Processando...</span>
            </div>
            <p class="mt-2 text-muted">Analisando referências...</p>
          </div>
        </div>
      </div>

      <!-- ETAPA 3: GERAÇÃO DO CONCEITO -->
      <div class="card shadow mb-4">
        <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">
            <span class="badge bg-white text-success rounded-circle me-2">3</span>
            Consolidação e Geração do Conceito Visual
          </h5>
          <div class="d-flex gap-2 align-items-center">
            <span class="badge bg-light text-dark" id="status-badge-3">Não Executado</span>
            <button class="btn btn-light btn-sm" onclick="executarEtapa3()" id="btn-etapa3">
              <i class="fas fa-magic text-success me-1"></i> Gerar
            </button>
          </div>
        </div>
        <div class="card-body">
          <p class="text-muted">
            <i class="fas fa-info-circle me-1"></i>
            Combina o layout (Etapa 1) com as inspirações (Etapa 2) para gerar o conceito visual.
          </p>
          
          <!-- Pré-requisitos -->
          <div class="alert alert-info" id="prerequisitos-3">
            <i class="fas fa-exclamation-circle me-2"></i>
            <strong>Pré-requisitos:</strong> Execute as Etapas 1 e 2 primeiro
          </div>

          <!-- Editor de Prompt -->
          <div class="mb-3 d-none" id="prompt-section">
            <label class="form-label fw-bold">Prompt de Geração:</label>
            <textarea class="form-control" id="prompt-editor" rows="6"></textarea>
            <small class="text-muted">Você pode editar o prompt antes de gerar a imagem</small>
          </div>

          <!-- Resultado -->
          <div class="result-container d-none" id="result-3">
            <div class="alert alert-success mb-3">
              <i class="fas fa-check-circle me-2"></i> Conceito visual gerado com sucesso!
            </div>
            
            <!-- Tabs para organizar informações -->
            <ul class="nav nav-tabs mb-3" role="tablist">
              <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-imagem">
                  <i class="fas fa-image me-1"></i> Imagem
                </button>
              </li>
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-dataset">
                  <i class="fas fa-database me-1"></i> Dataset
                </button>
              </li>
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-prompt">
                  <i class="fas fa-code me-1"></i> Prompt
                </button>
              </li>
            </ul>
            
            <div class="tab-content">
              <!-- Tab Imagem -->
              <div class="tab-pane fade show active" id="tab-imagem">
                <div class="text-center">
                  <img id="imagem-conceito" src="" alt="Conceito Visual" class="img-fluid rounded shadow mb-3" style="max-height:500px;">
                  <div>
                    <a id="link-download" href="" download class="btn btn-success me-2">
                      <i class="fas fa-download me-2"></i> Baixar Imagem
                    </a>
                    <button class="btn btn-outline-secondary" onclick="regenerarConceito()">
                      <i class="fas fa-redo me-1"></i> Regenerar
                    </button>
                  </div>
                </div>
              </div>
              
              <!-- Tab Dataset -->
              <div class="tab-pane fade" id="tab-dataset">
                <pre class="bg-light p-3 rounded small" id="dataset-json" style="max-height: 400px; overflow-y: auto;"></pre>
              </div>
              
              <!-- Tab Prompt -->
              <div class="tab-pane fade" id="tab-prompt">
                <div class="bg-light p-3 rounded" id="prompt-final-display"></div>
              </div>
            </div>
          </div>

          <!-- Loading -->
          <div class="text-center d-none" id="loading-3">
            <div class="spinner-border text-success" role="status">
              <span class="visually-hidden">Processando...</span>
            </div>
            <p class="mt-2 text-muted">Gerando conceito visual...</p>
          </div>
        </div>
      </div>
    </div>

    <!-- COLUNA DIREITA -->
    <div class="col-md-4">
      <!-- Status Geral -->
      <div class="card shadow mb-4">
        <div class="card-header bg-light">
          <h5 class="card-title mb-0"><i class="fas fa-tasks me-2"></i> Status do Processo</h5>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span><i class="fas fa-map me-1 text-primary"></i> Layout</span>
              <span id="status-1" class="badge bg-secondary">Pendente</span>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span><i class="fas fa-palette me-1 text-info"></i> Inspirações</span>
              <span id="status-2" class="badge bg-secondary">Pendente</span>
            </div>
            <div class="d-flex justify-content-between align-items-center">
              <span><i class="fas fa-image me-1 text-success"></i> Conceito</span>
              <span id="status-3" class="badge bg-secondary">Pendente</span>
            </div>
          </div>
          
          <hr>
          
          <!-- Indicadores de dados salvos -->
          <div class="text-center">
            <div class="d-none" id="dados-salvos-info">
              <small class="text-success">
                <i class="fas fa-database me-1"></i> Dados recuperados do banco
              </small>
            </div>
            <small class="text-muted d-block mt-2">
              Última atualização: <span id="ultima-atualizacao">-</span>
            </small>
          </div>
        </div>
      </div>

      <!-- Dados do Projeto -->
      <div class="card shadow mb-4">
        <div class="card-header bg-light">
          <h5 class="card-title mb-0"><i class="fas fa-info-circle me-2"></i> Dados do Projeto</h5>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-5">Empresa:</dt>
            <dd class="col-7">{{ projeto.empresa.nome }}</dd>
            
            {% if briefing %}
              <dt class="col-5">Dimensões:</dt>
              <dd class="col-7">
                {% if briefing.medida_frente and briefing.medida_fundo %}
                  {{ briefing.medida_frente }}m × {{ briefing.medida_fundo }}m
                {% else %}
                  <span class="text-muted">Não informado</span>
                {% endif %}
              </dd>
              
              <dt class="col-5">Área:</dt>
              <dd class="col-7">
                {% if briefing.area_estande %}
                  {{ briefing.area_estande }}m²
                {% else %}
                  <span class="text-muted">Não informado</span>
                {% endif %}
              </dd>
              
              <dt class="col-5">Tipo Stand:</dt>
              <dd class="col-7">{{ briefing.get_tipo_stand_display|default:"Não informado" }}</dd>
            {% endif %}
          </dl>
        </div>
      </div>

      <!-- Arquivos Disponíveis -->
      <div class="card shadow">
        <div class="card-header bg-light">
          <h5 class="card-title mb-0"><i class="fas fa-folder-open me-2"></i> Arquivos Disponíveis</h5>
        </div>
        <div class="card-body">
          <h6 class="text-primary">
            <i class="fas fa-map me-1"></i> Esboços ({{ arquivos_planta|length }})
          </h6>
          {% if arquivos_planta %}
            <ul class="list-unstyled small mb-3">
              {% for arquivo in arquivos_planta %}
                <li class="mb-1">
                  <i class="fas fa-file-image text-muted me-1"></i>
                  {{ arquivo.nome }}
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-muted small mb-3">Nenhum esboço disponível</p>
          {% endif %}
          
          <h6 class="text-info">
            <i class="fas fa-palette me-1"></i> Referências ({{ arquivos_referencia|length }})
          </h6>
          {% if arquivos_referencia %}
            <ul class="list-unstyled small mb-0">
              {% for arquivo in arquivos_referencia %}
                <li class="mb-1">
                  <i class="fas fa-image text-muted me-1"></i>
                  {{ arquivo.nome }}
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-muted small mb-0">Nenhuma referência disponível</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Script tags para dados JSON -->
{% if projeto.layout_identificado %}
{{ projeto.layout_identificado|json_script:"layout-data" }}
{% endif %}
{% if projeto.inspiracoes_visuais %}
{{ projeto.inspiracoes_visuais|json_script:"inspiracoes-data" }}
{% endif %}

<script>
// === Estado Global ===
let resultadoEtapa1 = null;
let resultadoEtapa2 = null;
let resultadoEtapa3 = null;

// === CSRF Token ===
function getCookie(name) {
  const match = document.cookie.match(new RegExp('(?:^|; )' + name + '=([^;]*)'));
  return match ? decodeURIComponent(match[1]) : '';
}
const CSRF_TOKEN = getCookie('csrftoken');

// === ETAPA 1: Análise de Esboço ===
async function executarEtapa1() {
  // UI
  document.getElementById('btn-etapa1').disabled = true;
  document.getElementById('loading-1').classList.remove('d-none');
  document.getElementById('result-1').classList.add('d-none');
  atualizarStatus(1, 'executando');
  
  try {
    // Sempre usa o primeiro arquivo disponível
    const response = await fetch(`/gestor/projeto/{{ projeto.id }}/conceito-visual/etapa1/`, {
      method: 'POST',
      headers: {
        'X-CSRFToken': CSRF_TOKEN,
        'Content-Type': 'application/json'
      },
      body: '{}'  // Sem arquivo_id específico
    });
    
    const data = await response.json();
    
    if (data.sucesso) {
      resultadoEtapa1 = data;
      
      // Mostrar resultado
      document.getElementById('layout-json').textContent = JSON.stringify(data.layout, null, 2);
      
      if (data.arquivo) {
        if (data.arquivo.nome) {
          document.getElementById('esboco-nome').textContent = data.arquivo.nome;
        }
        if (data.arquivo.url) {
          document.getElementById('esboco-thumb').src = data.arquivo.url;
        }
        document.getElementById('arquivo-info-1').classList.remove('d-none');
      }
      
      document.getElementById('result-1').classList.remove('d-none');
      atualizarStatus(1, 'concluido');
      verificarPreRequisitos();
      
    } else {
      alert(`Erro na Etapa 1: ${data.erro}`);
      atualizarStatus(1, 'erro');
    }
  } catch (error) {
    console.error('Erro:', error);
    alert('Erro ao executar Etapa 1');
    atualizarStatus(1, 'erro');
  } finally {
    document.getElementById('btn-etapa1').disabled = false;
    document.getElementById('loading-1').classList.add('d-none');
  }
}

// === ETAPA 2: Análise de Referências ===
async function executarEtapa2() {
  // UI
  document.getElementById('btn-etapa2').disabled = true;
  document.getElementById('loading-2').classList.remove('d-none');
  document.getElementById('result-2').classList.add('d-none');
  atualizarStatus(2, 'executando');
  
  try {
    const response = await fetch(`/gestor/projeto/{{ projeto.id }}/conceito-visual/etapa2/`, {
      method: 'POST',
      headers: {
        'X-CSRFToken': CSRF_TOKEN,
        'Content-Type': 'application/json'
      },
      body: '{}'
    });
    
    const data = await response.json();
    
    if (data.sucesso) {
      resultadoEtapa2 = data;
      
      // Mostrar resultado
      document.getElementById('inspiracoes-json').textContent = JSON.stringify(data.inspiracoes, null, 2);
      
      // Mostrar preview de cores se existir
      if (data.inspiracoes.cores_predominantes) {
        mostrarPreviewCores(data.inspiracoes.cores_predominantes);
      }
      
      document.getElementById('result-2').classList.remove('d-none');
      atualizarStatus(2, 'concluido');
      verificarPreRequisitos();
      
    } else {
      alert(`Erro na Etapa 2: ${data.erro}`);
      atualizarStatus(2, 'erro');
    }
  } catch (error) {
    console.error('Erro:', error);
    alert('Erro ao executar Etapa 2');
    atualizarStatus(2, 'erro');
  } finally {
    document.getElementById('btn-etapa2').disabled = false;
    document.getElementById('loading-2').classList.add('d-none');
  }
}

// === ETAPA 3: Geração do Conceito ===
async function executarEtapa3() {
  // Verificar pré-requisitos
  if (!resultadoEtapa1 || !resultadoEtapa2) {
    alert('Execute as Etapas 1 e 2 primeiro!');
    return;
  }
  
  const promptCustomizado = document.getElementById('prompt-editor').value.trim();
  
  // UI
  document.getElementById('btn-etapa3').disabled = true;
  document.getElementById('loading-3').classList.remove('d-none');
  document.getElementById('result-3').classList.add('d-none');
  atualizarStatus(3, 'executando');
  
  try {
    const body = promptCustomizado ? JSON.stringify({ prompt: promptCustomizado }) : '{}';
    
    const response = await fetch(`/gestor/projeto/{{ projeto.id }}/conceito-visual/etapa3/`, {
      method: 'POST',
      headers: {
        'X-CSRFToken': CSRF_TOKEN,
        'Content-Type': 'application/json'
      },
      body: body
    });
    
    const data = await response.json();
    
    if (data.sucesso) {
      resultadoEtapa3 = data;
      
      // Mostrar imagem
      document.getElementById('imagem-conceito').src = data.image_url;
      document.getElementById('link-download').href = data.download_url || data.image_url;
      
      // Mostrar dataset e prompt
      if (data.dataset_consolidado) {
        document.getElementById('dataset-json').textContent = JSON.stringify(data.dataset_consolidado, null, 2);
      }
      document.getElementById('prompt-final-display').textContent = data.prompt_usado;
      
      // Atualizar editor de prompt
      if (!promptCustomizado) {
        document.getElementById('prompt-editor').value = data.prompt_usado;
      }
      
      document.getElementById('result-3').classList.remove('d-none');
      atualizarStatus(3, 'concluido');
      
    } else {
      alert(`Erro na Etapa 3: ${data.erro || 'Erro desconhecido'}`);
      atualizarStatus(3, 'erro');
    }
  } catch (error) {
    console.error('Erro:', error);
    alert('Erro ao executar Etapa 3');
    atualizarStatus(3, 'erro');
  } finally {
    document.getElementById('btn-etapa3').disabled = false;
    document.getElementById('loading-3').classList.add('d-none');
  }
}

// === Processo Completo ===
async function executarProcessoCompleto() {
  if (!confirm('Executar todas as etapas em sequência?')) return;
  
  // Etapa 1
  if (!resultadoEtapa1) {
    await executarEtapa1();
    await new Promise(resolve => setTimeout(resolve, 1000));
  }
  
  // Etapa 2
  if (!resultadoEtapa2) {
    await executarEtapa2();
    await new Promise(resolve => setTimeout(resolve, 1000));
  }
  
  // Etapa 3
  if (resultadoEtapa1 && resultadoEtapa2) {
    await executarEtapa3();
  }
}

// === Funções Auxiliares ===
function atualizarStatus(etapa, status) {
  const badge = document.getElementById(`status-${etapa}`);
  const statusBadge = document.getElementById(`status-badge-${etapa}`);
  
  const configs = {
    'pendente': { class: 'bg-secondary', text: 'Pendente' },
    'executando': { class: 'bg-warning', text: 'Executando' },
    'concluido': { class: 'bg-success', text: 'Concluído' },
    'erro': { class: 'bg-danger', text: 'Erro' },
    'salvo': { class: 'bg-info', text: 'Dados Salvos' }
  };
  
  const config = configs[status] || configs['pendente'];
  
  [badge, statusBadge].forEach(el => {
    if (el) {
      el.className = `badge ${config.class}`;
      el.textContent = config.text;
    }
  });
  
  // Atualizar timestamp
  document.getElementById('ultima-atualizacao').textContent = new Date().toLocaleTimeString();
}

function verificarPreRequisitos() {
  // Verificar se pode executar Etapa 3
  if (resultadoEtapa1 && resultadoEtapa2) {
    document.getElementById('prerequisitos-3').classList.add('d-none');
    document.getElementById('prompt-section').classList.remove('d-none');
    
    // Se ainda não tem prompt, gerar um padrão
    if (!document.getElementById('prompt-editor').value) {
      document.getElementById('prompt-editor').value = 'Prompt será gerado automaticamente com base nos dados...';
    }
  }
}

function mostrarPreviewCores(cores) {
  if (!cores || !Array.isArray(cores)) return;
  
  const container = document.getElementById('cores-container');
  container.innerHTML = '';
  
  cores.forEach(cor => {
    if (cor.hex) {
      const div = document.createElement('div');
      div.style.width = '60px';
      div.style.height = '60px';
      div.style.backgroundColor = cor.hex;
      div.style.border = '2px solid #ddd';
      div.style.borderRadius = '4px';
      div.title = cor.uso || cor.hex;
      container.appendChild(div);
    }
  });
  
  document.getElementById('cores-preview').classList.remove('d-none');
}

function regenerarConceito() {
  if (confirm('Regenerar conceito visual?')) {
    executarEtapa3();
  }
}

// === Carregar Dados Salvos ===
function carregarDadosSalvos() {
  let houveCarregamento = false;
  
  // Carregar layout salvo
  const layoutElement = document.getElementById('layout-data');
  if (layoutElement) {
    try {
      const layoutSalvo = JSON.parse(layoutElement.textContent);
      if (layoutSalvo && (layoutSalvo.areas || Object.keys(layoutSalvo).length > 0)) {
        resultadoEtapa1 = {
          layout: layoutSalvo,
          sucesso: true
        };
        
        document.getElementById('layout-json').textContent = JSON.stringify(layoutSalvo, null, 2);
        document.getElementById('result-1').classList.remove('d-none');
        atualizarStatus(1, 'salvo');
        houveCarregamento = true;
      }
    } catch (e) {
      console.error('Erro ao carregar layout:', e);
    }
  }
  
  // Carregar inspirações salvas
  const inspiracoesElement = document.getElementById('inspiracoes-data');
  if (inspiracoesElement) {
    try {
      const inspiracoesSalvas = JSON.parse(inspiracoesElement.textContent);
      if (inspiracoesSalvas && Object.keys(inspiracoesSalvas).length > 0) {
        resultadoEtapa2 = {
          inspiracoes: inspiracoesSalvas,
          sucesso: true
        };
        
        document.getElementById('inspiracoes-json').textContent = JSON.stringify(inspiracoesSalvas, null, 2);
        document.getElementById('result-2').classList.remove('d-none');
        
        if (inspiracoesSalvas.cores_predominantes) {
          mostrarPreviewCores(inspiracoesSalvas.cores_predominantes);
        }
        
        atualizarStatus(2, 'salvo');
        houveCarregamento = true;
      }
    } catch (e) {
      console.error('Erro ao carregar inspirações:', e);
    }
  }
  
  if (houveCarregamento) {
    document.getElementById('dados-salvos-info').classList.remove('d-none');
    verificarPreRequisitos();
  }
}

// === Inicialização ===
document.addEventListener('DOMContentLoaded', function() {
  // Carregar dados salvos
  carregarDadosSalvos();
  
  // Verificar disponibilidade de arquivos
  {% if not arquivos_planta %}
    document.getElementById('btn-etapa1').disabled = true;
    document.getElementById('btn-etapa1').innerHTML = '<i class="fas fa-times me-1"></i> Sem Esboços';
  {% endif %}
  
  {% if not arquivos_referencia %}
    document.getElementById('btn-etapa2').disabled = true;
    document.getElementById('btn-etapa2').innerHTML = '<i class="fas fa-times me-1"></i> Sem Referências';
  {% endif %}
});
</script>

<style>
/* Estilos customizados */
.badge.rounded-circle {
  width: 28px;
  height: 28px;
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

.nav-tabs .nav-link {
  color: #6c757d;
  border: 1px solid transparent;
  background: transparent;
}

.nav-tabs .nav-link.active {
  color: #495057;
  background-color: #fff;
  border-color: #dee2e6 #dee2e6 #fff;
}

.tab-content {
  border: 1px solid #dee2e6;
  border-top: none;
  padding: 1rem;
  background: white;
}

#cores-container > div {
  cursor: pointer;
  transition: transform 0.2s;
}

#cores-container > div:hover {
  transform: scale(1.1);
}
</style>
{% endblock %}